<h1>Memory Browser</h1>

<div class="memory-tree">
    <ul>
        {% for key, value in tree.items() recursive %}
            <li>
                {% if key == '...' %}
                    <span class="more">⋯</span> {{ value }}
                {% elif value.is_file is defined and value.is_file %}
                    <span class="file">📄</span>
                    <a href="/view/{{ value.path }}">{{ value.name }}</a>
                {% elif value.children is defined %}
                    <span class="directory">📁</span>
                    <a href="/browse/{{ value.path }}">{{ value.name }}</a>
                    {% if value.children|length > 0 %}
                    <ul>
                        {{ loop(value.children.items()) }}
                    </ul>
                    {% endif %}
                {% else %}
                    <!-- If no children are defined and it's not explicitly marked as a file, 
                         we need to determine if it's a leaf node -->
                    {% if value|length == 0 or (value.path is defined and not value.children) %}
                        <span class="file">📄</span>
                        <a href="/view/{{ value.path }}">{{ value.name }}</a>
                    {% else %}
                        <span class="directory">📁</span>
                        <a href="/browse/{{ value.path }}">{{ value.name }}</a>
                    {% endif %}
                {% endif %}
            </li>
        {% endfor %}
    </ul>
</div>